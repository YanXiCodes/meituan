# T6 & T7 教案代码使用说明 (README.md)

## 1. 概述

**本教案包含两个核心的Python代码文件，它们分别对应T6和T7两个课程阶段，体现了从**基础功能实现**到**系统性分析与完善**的演进过程。**

* 编程实现将动态规划用于优化基于树的文件系统查询 例.docx。
* **T7 最终代码**: 即 **T7\_DPFileSystem\_final.py** **文件。**

**请务必理解这两个文件的不同角色，以便在教学和学习中正确使用。**

---

## 2. 文件说明

### 2.1 T6 基础代码 (**例.docx** **中的代码)**

* **角色**: **T6课程的核心教学代码与基础实现。**
* **内容**:

  * **包含** **TreeNode** **和** **DPFileSystem** **两个核心类。**
  * **实现了基于动态规划的**核心优化逻辑**，包括：**

    * **get\_total\_size()**: 带缓存的查询方法。
    * **\_update\_ancestor\_cache()**: 核心的缓存更新函数。
    * **add\_node**, **remove\_node**, **move\_node**: 在结构变化时调用缓存更新。
  * **包含一个简单的** **if \_\_name\_\_ == "\_\_main\_\_":** **测试用例，用于**功能演示**。**
* **教学目的**:
  让学生从零开始，掌握将动态规划思想（记忆化、动态更新）应用于实际问题的**编程实现能力**。
* **局限性**:
  这是一个功能验证版，从软件工程角度看，它缺少严格的性能测试和对所有场景（如文件内容修改）的处理，存在设计的局限性。

### 2.2 T7 最终代码 (**T7\_DPFileSystem\_final.py**)

* **角色**: **T7课程的最终成果与完整测试脚本。**
* **内容**:

  * **完全包含**了T6的所有代码。
  * **在此基础上，根据T7的教学目标，**新增了以下关键部分**：**

    * **get\_total\_size\_naive()** **方法**: 一个无缓存的、模拟T5暴力遍历的查询方法，用于性能对比。
    * **update\_file\_size()** **方法**: 修复了T6代码的“缓存一致性”缺陷，当文件大小变化时，能够同步更新缓存。
    * **generate\_test\_tree()** **辅助函数**: 用于自动化地生成大规模、随机的测试文件树，是进行有效性能测试的基础。
    * **一个更全面的测试主程序**: 用于执行系统的性能测试，并打印出包含真实耗时和性能提升倍数的分析报告。
* **教学目的**:
  让学生在T6的基础上，学习如何对一个已有的系统进行**复杂度分析、性能测试和综合优化**，掌握更高级的软件工程实践能力。

---

## 3. 主要不同点对比


| **功能点**             | **T6 基础代码 (**例.docx**)** | **T7 最终代码 (**T7\_final.py**)**     |
| ---------------------- | ----------------------------- | -------------------------------------- |
| **基本DP优化**         | **已实现**                    | **已包含**                             |
| **T5暴力法对比**       | **未实现**                    | **新增** **get\_total\_size\_naive()** |
| **缓存一致性修复**     | **未实现 (存在缺陷)**         | **新增** **update\_file\_size()**      |
| **自动化测试数据生成** | **未实现**                    | **新增** **generate\_test\_tree()**    |
| **综合性能测试程序**   | **仅有简单功能演示**          | **已实现**                             |

---

## 4. 如何正确使用

### 4.1 在T6课程中

* **应使用** **例.docx** **中的代码作为核心教学材料。**
* **重点讲解** **get\_total\_size** **和** **\_update\_ancestor\_cache** **的实现原理，让学生理解动态规划是如何通过编码落地的。**
* **if \_\_name\_\_ == "\_\_main\_\_":** **部分用于向学生**演示**功能是可行的，并初步展示性能提升。**

### 4.2 在T7课程中

* **回顾与分析**:
  从 **例.docx** **的代码出发，引导学生对其进行**复杂度分析**，并发现其**设计局限性**（如无法处理文件大小修改、测试不充分等）。**
* **编码与完善**:
  将 **T7\_DPFileSystem\_final.py** **作为最终的参考答案。重点讲解其中**新增**的** **generate\_test\_tree** **和** **update\_file\_size** **函数，它们分别是T7中“量化测试”和“综合优化”两个任务的编程实践。**
* **运行与验证**:
  直接运行 **T7\_DPFileSystem\_final.py** **脚本，让学生亲眼看到在大规模数据下，真实的性能测试结果，从而验证理论分析的正确性。**

---

## 5. 运行 T7 最终脚本

* **将** **T7\_DPFileSystem\_final.py** **文件的完整代码保存到一个Python文件中。**
* **打开终端或命令行工具。**
* **执行命令：**python T7\_DPFileSystem\_final.py
* **观察控制台输出的测试报告，该报告将包含真实的耗时数据和性能提升倍数，可直接用于PPT中“测试结果的可视化”页面。**
